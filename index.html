<!DOCTYPE html>
<html lang="th">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>แบบประเมินความเสี่ยงการลงทุน</title>

  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

  <style>
    :root {
      --primary: #0b5ed7;
      --bg: #f4f6f8;
      --card: #fff;
      --text: #1b1f24;
      --muted: #6b7280;
      --border: #e5e7eb;
    }

    body {
      font-family: Tahoma, sans-serif;
      background: var(--bg);
      margin: 0;
      padding: 24px;
      color: var(--text);
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
    }

    .card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 22px;
      box-shadow: 0 4px 18px rgba(0, 0, 0, .06);
    }

    h1 {
      margin: 0 0 6px 0;
      font-size: 26px;
    }

    .subtitle {
      margin: 0 0 18px 0;
      color: var(--muted);
      font-size: 14px;
    }

    .question {
      margin: 14px 0;
      padding: 14px;
      border: 1px solid var(--border);
      border-radius: 10px;
      background: #fafafa;
    }

    .question-title {
      font-weight: 700;
      margin-bottom: 10px;
    }

    .choices {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .choice {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 12px;
      background: #fff;
      border: 1px solid #cbd5e1;
      border-radius: 10px;
      cursor: pointer;
    }

    .actions {
      display: flex;
      gap: 12px;
      margin-top: 16px;
    }

    button {
      padding: 12px 16px;
      border-radius: 10px;
      border: none;
      cursor: pointer;
      font-size: 16px;
    }

    .btn-primary {
      background: var(--primary);
      color: #fff;
    }

    .btn-secondary {
      background: #e5e7eb;
    }

    .result {
      margin-top: 18px;
      display: none;
      padding: 16px;
      border-radius: 10px;
      border: 1px solid var(--border);
    }

    .badge {
      padding: 6px 12px;
      border-radius: 999px;
      font-weight: 700;
      margin-left: 6px;
    }

    .low {
      background: #dcfce7;
      color: #166534;
    }

    .medium {
      background: #fef9c3;
      color: #854d0e;
    }

    .high {
      background: #fee2e2;
      color: #991b1b;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 12px;
    }

    th,
    td {
      border: 1px solid var(--border);
      padding: 10px;
      text-align: center;
    }

    th {
      background: #f1f5f9;
    }
  </style>
</head>

<body>
  <div class="container">

    <!-- Intro -->
    <div id="intro" class="card">
      <h2>แบบประเมินความเสี่ยงการลงทุน</h2>
      <p>ชื่อ-สกุล</p>
      <input id="fullname" style="width:100%;padding:10px">
      <br><br>
      <button onclick="start()">เริ่มทำแบบประเมิน</button>
    </div>

    <!-- Assessment -->
    <div id="assessment" class="card" style="display:none">
      <h3>ผู้ทำแบบประเมิน: <span id="showName"></span></h3>

      <form id="riskForm">

        <div class="question">
          <b>1 อายุปัจจุบันของท่าน</b>
          <label class="choice"><input type="radio" name="q1" value="1" required> มากกว่า 55</label>
          <label class="choice"><input type="radio" name="q1" value="2"> 45–55</label>
          <label class="choice"><input type="radio" name="q1" value="3"> 35–45</label>
          <label class="choice"><input type="radio" name="q1" value="4"> ต่ำกว่า 35</label>
        </div>

        <div class="question">
          <b>2 รายได้ต่อเดือน</b>
          <label class="choice"><input type="radio" name="q2" value="1" required>
            < 15,000</label>
              <label class="choice"><input type="radio" name="q2" value="2"> 15,000–30,000</label>
              <label class="choice"><input type="radio" name="q2" value="3"> 30,001–50,000</label>
              <label class="choice"><input type="radio" name="q2" value="4"> 50,000</label>
        </div>

        <div class="question">
          <b>3 ปัจจุบันท่านมีภาระทางการเงินและค่าใช้จ่ายประจำเช่น ค่าผ่อนบ้าน รถ
            ค่าใช้จ่ายส่วนตัวและค่าเลี้ยงดูครอบครัวเป็นสัดส่วนเท่าใด</b>
          <label class="choice"><input type="radio" name="q3" value="1" required> > มากกว่าร้อยละ 75
            ของรายได้ทั้งหมด</label>
          <label class="choice"><input type="radio" name="q3" value="2"> ระหว่างร้อยละ 50 ถึง 75
            ของรายได้ทั้งหมด</label>
          <label class="choice"><input type="radio" name="q3" value="3"> ระหว่างร้อยละ 25 ถึง 50
            ของรายได้ทั้งหมด</label>
          <label class="choice"><input type="radio" name="q3" value="4"> น้อยกว่าร้อยละ 25 ของรายได้ทั้งหมด</label>
        </div>

        <div class="question">
          <b>4 คุณมีสถานภาพทางการเงินปัจจุบันอย่างไร</b>
          <label class="choice"><input type="radio" name="q4" value="1" required> > มีสินทรัพย์น้อยกว่าหนี้สิน</label>
          <label class="choice"><input type="radio" name="q4" value="2"> มีสินทรัพย์เท่ากับหนี้สิน</label>
          <label class="choice"><input type="radio" name="q4" value="3"> มีทรัพย์สินมากกว่าหนี้สิน</label>
          <label class="choice"><input type="radio" name="q4" value="4">
            มีความมั่นใจว่ามีเงินออมหรือเงินลงทุนเพียงพอสำหรับการใช้ชีวิตหลังเกษียณแล้ว</label>
        </div>

        <div class="question">
          <b>5 คุณเคยมีประสบการณ์ หรือมีความรู้ในการลงทุนในทรัพย์สินกลุ่มใดต่อไปนี้บ้าง (เลือกได้มากกว่า 1 ข้อ)</b>
          <label class="choice"><input type="radio" name="q5" value="1" required> > เงินฝากธนาคาร</label>
          <label class="choice"><input type="radio" name="q5" value="2"> พันธบัตรรัฐบาล
            หรือกองทุนรวมพันธบัตรรัฐบาล</label>
          <label class="choice"><input type="radio" name="q5" value="3"> หุ้นกู้ หรือกองทุนรวมตราสารหนี้</label>
          <label class="choice"><input type="radio" name="q5" value="4"> หุ้นสามัญ หรือกองทุนรวมหุ้น
            หรือสินทรัพย์อื่นที่มีความเสี่ยงสูง</label>
        </div>

        <div class="question">
          <b>6 ระยะเวลาที่คุณคาดว่าจะไม่มีความจำเป็นต้องใช้เงินลงทุนนี้</b>
          <label class="choice"><input type="radio" name="q6" value="1" required> > ไม่เกิน 1 ปี</label>
          <label class="choice"><input type="radio" name="q6" value="2"> 1 ถึง 3 ปี</label>
          <label class="choice"><input type="radio" name="q6" value="3"> 3 ถึง 5 ปี</label>
          <label class="choice"><input type="radio" name="q6" value="4"> มากกว่า 5 ปี</label>
        </div>

        <div class="question">
          <b>7 วัตถุประสงค์หลักในการลงทุนของคุณ คือ</b>
          <label class="choice"><input type="radio" name="q7" value="1" required> >
            เน้นเงินต้นต้องปลอดภัยและได้รับผลตอบแทนสม่ำเสมอแต่ต่ำได้</label>
          <label class="choice"><input type="radio" name="q7" value="2"> เน้นโอกาสได้รับผลตอบแทนที่สม่ำเสมอ
            แต่อาจเสี่ยงที่จะสูญเสียเงินต้นได้บ้าง</label>
          <label class="choice"><input type="radio" name="q7" value="3"> เน้นโอกาสได้รับผลตอบแทนที่สูงขึ้น
            แต่อาจเสี่ยงที่จะสูญเสียเงินต้นได้มากขึ้น</label>
          <label class="choice"><input type="radio" name="q7" value="4"> เน้นผลตอบแทนสูงสุดในระยะยาว
            แต่อาจเสี่ยงที่จะสูญเงินต้นส่วนใหญ่ได้</label>
        </div>

        <div class="question">
          <b>8 เมื่อพิจารณาตัวอย่างผลตอบแทนของกลุ่มการลงทุนที่อาจเกิดขึ้นด้านล่าง คุณเต็มใจที่จะลงทุนในกลุ่มใด</b>
          <label class="choice"><input type="radio" name="q8" value="1" required> > กลุ่มการลงทุนที่ 1: โอกาสได้ผลตอบแทน
            2.5% โดย ไม่ขาดทุน</label>
          <label class="choice"><input type="radio" name="q8" value="2"> กลุ่มการลงทุนที่ 2: ผลตอบแทนสูงสุด 7% แต่
            อาจขาดทุนได้ถึง 1%</label>
          <label class="choice"><input type="radio" name="q8" value="3"> กลุ่มการลงทุนที่ 3: ผลตอบแทนสูงสุด 15% แต่
            อาจขาดทุนได้ถึง 5%</label>
          <label class="choice"><input type="radio" name="q8" value="4"> กลุ่มการลงทุนที่ 4: ผลตอบแทนสูงสุด 25% แต่
            อาจขาดทุนได้ถึง 15%</label>
        </div>

        <div class="question">
          <b>9 ท่านสนใจ DR ของประเทศไหน</b>

          <label class="choice">
            <input type="radio" name="q9_country" value="ALL" required>
            ไม่ระบุ (แสดงทั้งหมด)
          </label>

          <label class="choice">
            <input type="radio" name="q9_country" value="สหรัฐอเมริกา">
            สหรัฐอเมริกา
          </label>

          <label class="choice">
            <input type="radio" name="q9_country" value="ฮ่องกง">
            ฮ่องกง
          </label>

          <label class="choice">
            <input type="radio" name="q9_country" value="ญี่ปุ่น">
            ญี่ปุ่น
          </label>

          <label class="choice">
            <input type="radio" name="q9_country" value="เนเธอร์แลนด์">
            เนเธอร์แลนด์
          </label>

          <label class="choice">
            <input type="radio" name="q9_country" value="เยอรมนี">
            เยอรมนี
          </label>

          <label class="choice">
            <input type="radio" name="q9_country" value="สวิตเซอร์แลนด์">
            สวิตเซอร์แลนด์
          </label>

          <label class="choice">
            <input type="radio" name="q9_country" value="อังกฤษ/ยุโรป">
            อังกฤษ/ยุโรป
          </label>

          <label class="choice">
            <input type="radio" name="q9_country" value="ฝรั่งเศส">
            ฝรั่งเศส
          </label>

          <label class="choice">
            <input type="radio" name="q9_country" value="ไต้หวัน">
            ไต้หวัน
          </label>

          <label class="choice">
            <input type="radio" name="q9_country" value="เกาหลีใต้">
            เกาหลีใต้
          </label>
        </div>

        <div class="question">
          <b>10 ท่านสนใจหุ้นไทยกลุ่ม Industrials ไหน</b>

          <label class="choice">
            <input type="radio" name="q10_industry" value="ALL" required>
            ไม่ระบุ (แสดงทั้งหมด)
          </label>

          <label class="choice">
            <input type="radio" name="q10_industry" value="FINCIAL">
            FINCIAL
          </label>

          <label class="choice">
            <input type="radio" name="q10_industry" value="CONSUMP">
            CONSUMP
          </label>

          <label class="choice">
            <input type="radio" name="q10_industry" value="AGRO">
            AGRO
          </label>

          <label class="choice">
            <input type="radio" name="q10_industry" value="INDUS">
            INDUS
          </label>

          <label class="choice">
            <input type="radio" name="q10_industry" value="TECH">
            TECH
          </label>

          <label class="choice">
            <input type="radio" name="q10_industry" value="RESOURC">
            RESOURC
          </label>

          <label class="choice">
            <input type="radio" name="q10_industry" value="SERVICE">
            SERVICE
          </label>

        </div>

        <button>ประเมินผล</button>
      </form>
    </div>

    <!-- Result -->
    <div id="result" class="card" style="display:none"></div>

  </div>

  <script>
    /* ================================
       Excel Base64 (ใส่เอง)
    ================================ */
    const EMBEDDED_EXCEL_BASE64 = `
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

`;


    function loadEmbeddedExcel() {
      const binary = atob(EMBEDDED_EXCEL_BASE64);
      const bytes = new Uint8Array(binary.length);
      for (let i = 0; i < binary.length; i++) {
        bytes[i] = binary.charCodeAt(i);
      }
      return XLSX.read(bytes, { type: "array" });
    }

    const wb = loadEmbeddedExcel();
    const excelData = {};
    wb.SheetNames.forEach(name => {
      excelData[name] = XLSX.utils.sheet_to_json(
        wb.Sheets[name],
        { defval: "" }
      );
    });

    /* ================================
       UI Logic
    ================================ */
    function start() {
      if (!fullname.value.trim()) return alert("กรุณากรอกชื่อ");
      showName.textContent = fullname.value;
      intro.style.display = "none";
      assessment.style.display = "block";
    }

    function riskToStyle(score) {
      if (score <= 10) {
        return {
          label: "Dividend",
          styles: ["Dividend"],
          p: [
            ["เงินฝาก", "70%"],
            ["ตราสารหนี้", "25%"],
            ["หุ้น", "5%"]
          ]
        };
      }

      if (score <= 40) {
        return {
          label: "Value",
          styles: ["Value"],
          p: [
            ["เงินฝาก", "40%"],
            ["ตราสารหนี้", "40%"],
            ["หุ้น", "20%"]
          ]
        };
      }

      return {
        label: "Growth",
        styles: ["Growth"],
        p: [
          ["เงินฝาก", "20%"],
          ["ตราสารหนี้", "30%"],
          ["หุ้น", "50%"]
        ]
      };
    }


    function styleClass(style) {
      if (style === "Dividend") return "low";
      if (style === "Value") return "medium";
      return "high";
    }

    function renderTable(rows) {
      if (!rows.length) return "<p>ไม่มีข้อมูล</p>";

      const hiddenCols = [];

      const headers = Object.keys(rows[0])
        .filter(h => !hiddenCols.includes(h));

      return `
    <table>
      <tr>${headers.map(h => `<th>${h}</th>`).join("")}</tr>
      ${rows.map(r => `
        <tr>
          ${headers.map(h => `<td>${r[h]}</td>`).join("")}
        </tr>
      `).join("")}
    </table>
  `;
    }

    function renderThaiByIndustry(rows) {
      if (!rows.length) return "<p>ไม่มีข้อมูล</p>";

      // เอาค่า Industrials ที่ไม่ซ้ำ ตามลำดับที่เจอใน Excel
      const industries = [...new Set(
        rows.map(r => String(r["Industrials"] || "").trim())
          .filter(v => v)
      )];

      let html = "";

      industries.forEach(ind => {
        const groupRows = rows.filter(r =>
          String(r["Industrials"] || "").trim() === ind
        );

        if (groupRows.length) {
          html += `
        <h5>${ind}</h5>
        ${renderTable(groupRows)}
      `;
        }
      });

      return html;
    }

    /* ================================
       Submit
    ================================ */
    riskForm.addEventListener("submit", async (e) => {
      e.preventDefault();


      const fd = new FormData(riskForm);
      let score = 0;


      ["q1", "q2", "q3", "q4", "q5", "q6", "q7", "q8"]
        .forEach(q => score += Number(fd.get(q)));


      const risk = riskToStyle(score);

      const selectedCountry = String(fd.get("q9_country") || "ALL").trim();

      const selectedIndustry = String(fd.get("q10_industry") || "ALL").trim();

      const funds = (excelData["กองทุน"] || [])
        .filter(x => risk.styles.includes(x["ความเสี่ยง"]));


      const thaiStocks = (excelData["หุ้นไทย"] || [])
        .filter(x =>
          risk.styles.some(style =>
            style.trim() === String(x["ประเภท"] || "").trim()
          )
        )
        .filter(x => {
          if (selectedIndustry === "ALL") return true;
          const ind = String(x["Industrials"] || "").trim();
          return ind === selectedIndustry;
        });


      const drStocks = (excelData["DR"] || [])
        // ✅ กรองตาม Risk โดยใช้คอลัมน์ US DR
        .filter(x => risk.styles.includes(String(x["US DR"] || "").trim()))
        // ✅ กรองตามประเทศที่เลือก
        .filter(x => {
          if (selectedCountry === "ALL") return true;

          const country = String(x["ประเทศ"] || "").trim();
          return country === selectedCountry;
        });


      // ✅ เพิ่ม: ส่งไปบันทึก DB
      try {
        await fetch("http://localhost:3000/api/risk-assessment", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            fullName: fullname.value.trim(),
            score,
            riskLabel: risk.label,
            answers: {
              q1: Number(fd.get("q1")),
              q2: Number(fd.get("q2")),
              q3: Number(fd.get("q3")),
              q4: Number(fd.get("q4")),
              q5: Number(fd.get("q5")),
              q6: Number(fd.get("q6")),
              q7: Number(fd.get("q7")),
              q8: Number(fd.get("q8")),
            },
            portfolio: risk.p.map(x => ({ asset: x[0], percent: x[1] })),
            funds,
            thaiStocks,
            drStocks,
            selectedCountry,
            selectedIndustry,
          }),
        });
      } catch (err) {
        console.error("Save failed:", err);
        alert("บันทึกข้อมูลไม่สำเร็จ กรุณาลองใหม่");
      }

      result.innerHTML = `
  <div class="summary-card">

    <div class="summary-header">
      <div class="score">
        คะแนนรวม: <b>${score}</b>
      </div>
      <div class="risk">
        ระดับความเสี่ยง:
        <span class="risk-badge ${styleClass(risk.label)}">
          ${risk.label === "Value" ? "ปานกลาง" :
          risk.label === "Dividend" ? "ต่ำ" : "สูง"}
        </span>
      </div>
    </div>

    <table class="portfolio-table">
      <thead>
        <tr>
          <th>สินทรัพย์</th>
          <th>สัดส่วน</th>
        </tr>
      </thead>
      <tbody>
        ${risk.p.map(p => `
          <tr>
            <td>${p[0]}</td>
            <td>${p[1]}</td>
          </tr>
        `).join("")}
      </tbody>
    </table>

  </div>

  <h4>กองทุน</h4>
  ${renderTable(funds)}

  <h4>หุ้นไทย (${risk.label})</h4>
  ${renderThaiByIndustry(thaiStocks)}

  <h4>DR (${risk.label})</h4>
  ${renderTable(drStocks)}
`;

      assessment.style.display = "none";
      result.style.display = "block";
    });
  </script>

</body>

</html>